# -*- coding: utf-8 -*-
"""prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Aq015pAghuUNAl32u0rIUFedXQmrvR3l
"""

from tensorflow.keras.datasets import imdb
import numpy as np
from tensorflow.keras.models import load_model
import tensorflow as tf

word_index = imdb.get_word_index()
reverse_word_index = dict([(value, key) for (key, value) in word_index.items()])

model = load_model('/content/rnn_imdb.h5')

from tensorflow.keras.preprocessing import sequence
def decode_review(encoded_review):
  return ' '.join([reverse_word_index.get(i - 3, '?') for i in encoded_review])

def preprocess_text(text):
  words = text.lower().split()
  encoded_review = [word_index.get(word, 2) + 3 for word in words]
  padded_review = sequence.pad_sequences([encoded_review],maxlen = 500)
  return padded_review

def predict_sentimemt(review):
  preprocessed_review = preprocess_text(review)
  prediction = model.predict(preprocessed_review)
  sentiment=  'Positive' if prediction[0][0] >0.5 else'Negative'
  return sentiment, prediction[0][0]

